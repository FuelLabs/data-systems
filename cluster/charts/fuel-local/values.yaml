docker:
  registry: registry.dev.svc.cluster.local:5000

config:
  namespace: fuel-local
  # Override the name and fullname of the chart
  nameOverride: ""
  fullnameOverride: ""
  # Enable network policy that allows only traffic from the fuel-local namespace
  networkPolicy: true
  # Wait for service dependencies to be ready before starting the fuel-local services
  waitForServiceDependencies: true
  # Create roles and rolebindings for the fuel-local serviceaccount
  createRoles: true
  # Enable high availability mode and pod anti-affinity for stateful services
  highAvailability: false
  # Enable health checks for all services
  healthChecks: true

serviceAccount:
  name: fuel-local-serviceaccount
  create: true
  automount: true

elasticsearch:
  enabled: true
  image: "docker.elastic.co/elasticsearch/elasticsearch"
  tag: "8.15.5"
  storage: 1Gi
  containerSecurityContext:
    readOnlyRootFilesystem: false
  probes:
    healthPath: "/_cluster/health"
    port: 9200
    scheme: "http"
  resources:
    limits:
      cpu: 2
      memory: 4Gi
    requests:
      cpu: 500m
      memory: 2Gi

grafana:
  enabled: true
  image: "grafana/grafana"
  tag: "11.3.1"
  storage: 2Gi
  configFilesFolders: {}
  probes:
    healthPath: "/api/health"
    port: 3000
  containerSecurityContext:
    readOnlyRootFilesystem: false # Allow writing to filesystem
  # Optional overrides
  # resources: {}
  # securityContext: {}
  # containerSecurityContext: {}
  # affinity: {}

prometheus:
  enabled: true
  image: "prom/prometheus"
  tag: "v2.53.3"
  storage: 5Gi
  configFilesFolders: {}
  probes:
    healthPath: "/-/healthy"
    port: 9090
  containerSecurityContext:
    readOnlyRootFilesystem: false # Allow writing to filesystem
  # Optional overrides
  # resources: {}
  # securityContext: {}
  # affinity: {}

fuel-streams-publisher:
  # You dont need to setup your secrets here because they will be generated automatically by Tilt
  image:
    repository: "fuel-streams-publisher"
    pullPolicy: Never
    tag: latest
  persistence:
    data:
      size: 50Gi
      storageClass: standard
    temp:
      size: 5Gi
      storageClass: standard

fuel-nats:
  container:
    env:
      NATS_SYSTEM_PASS: temp-system-pass
      NATS_ADMIN_PASS: temp-admin-pass

# -------------------------------------------------------------------------------------------------
# Default configurations that can be overridden by services
# -------------------------------------------------------------------------------------------------

global:
  securityContext:
    enabled: true
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000
    seccompProfile:
      type: RuntimeDefault

  containerSecurityContext:
    enabled: true
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
    readOnlyRootFilesystem: true
    runAsNonRoot: true
    runAsUser: 1000
    privileged: false

  resources:
    enabled: true
    requests:
      cpu: 0.05
      memory: 10Mi
    limits:
      cpu: 1
      memory: 500Mi

  probes:
    liveness:
      enabled: true
      initialDelaySeconds: 60
      periodSeconds: 20
      timeoutSeconds: 10
      failureThreshold: 6
      successThreshold: 1
    readiness:
      enabled: true
      initialDelaySeconds: 30
      periodSeconds: 20
      timeoutSeconds: 10
      failureThreshold: 6
      successThreshold: 1
    startup:
      enabled: true
      initialDelaySeconds: 60
      periodSeconds: 20
      timeoutSeconds: 10
      failureThreshold: 30
      successThreshold: 1

  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app.kubernetes.io/name: fuel-local
            topologyKey: kubernetes.io/hostname
